<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Introduction to data frames and Polars – BE/Bi 103 a 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../lessons/eda/polars/tidy_data.html" rel="next">
<link href="../../../lessons/eda/exploratory_data_analysis.html" rel="prev">
<link href="../../../logo.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-236d90495073fb2ac8939117e3e83141.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-8b050a7f4e1f1dd4af2b4d23fb288ab7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../custom.css">
</head>

<body class="nav-sidebar floating slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../lessons/eda/exploratory_data_analysis.html">Exploratory data analysis</a></li><li class="breadcrumb-item"><a href="../../../lessons/eda/polars/intro_to_polars.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to data frames and Polars</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../../index.html" class="sidebar-logo-link">
      <img src="../../../logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../"></a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the course</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course logistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../policies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course policies</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/what_are_we_doing/what_are_we_doing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What are we doing?</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../lessons/eda/exploratory_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory data analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/polars/intro_to_polars.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to data frames and Polars</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/polars/tidy_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tidy data and split-apply-combine</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/polars/styling_data_frames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Styling data frames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/polars/polars_for_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Polars for Pandas users</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/plotting/plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data display</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/plotting/plotting_with_bokeh.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Making plots with Bokeh</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/plotting/plotting_smooth_curves.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Plotting smooth curves</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/plotting/categorical_axes_bokeh.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Plots with categorical variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/plotting/visualizing_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualizing distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/plotting/iqplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">High level plotting with iqplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/plotting/styling_bokeh.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Styling Bokeh plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/wrangling/manipulating_data_frames_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Manipulating data frames and wrangling data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/wrangling/merging_dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Merging and concatenating data frames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/wrangling/unpivoting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Making a data frame tall</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/wrangling/pivoting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Making a data frame wide</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/eda/eda_lesson_exercise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">EDA lesson exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../lessons/probability_and_sampling/probability_and_sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability: The foundation for generative modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/probability_and_sampling/definition_and_interpretation_of_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Probability: definitions and interpretations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/probability_and_sampling/probability_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Probability distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/probability_and_sampling/random_number_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Random number generation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/probability_and_sampling/rng_with_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Random number generation using Numpy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/probability_and_sampling/luria_delbruck.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Simulating the Luria-Delbrück distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/probability_and_sampling/probability_and_sampling_lesson_exercise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Probability and sampling lesson exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../lessons/nonparametric/nonparametric_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nonparametric inference and confidence intervals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/nonparametric/plugin/point_estimates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Plug-in estimates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/nonparametric/plugin/bias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Bias</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/nonparametric/plugin/confidence_intervals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Confidence intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/nonparametric/bootstrap/intro_bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Performing bootstrap calculations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/nonparametric/bootstrap/pairs_bootstrap_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Pairs bootstrap and correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lessons/nonparametric/nonparametric_lesson_exercise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Nonparametric inference lesson exercise</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Homework</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../homework/plotting_an_elephant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 1.1: Plotting an elephant</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../homework/penguins_split_apply_combine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 1.2: Palmer penguins and split-apply-combine</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../homework/mt_ecdf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 2.1: Microtubule catastrophe and ECDFs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../homework/cool_gal4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 2.2: EDA for a temperature controlled Gal4-UAS system</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../homework/beetle_hypnotists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 3.1: Beetle hypnotists</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../homework/marginal_binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 3.2: A marginal distribution</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Computing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/setting_up_python_computing_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Configuring your computer to use Python for scientific computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/notebooks_and_latex/intro_to_jupyterlab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to JupyterLab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/notebooks_and_latex/intro_to_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Introduction to LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/hello_world.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Hello, world.</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/variables_operators_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Variables, operators, and types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/lists_and_tuples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Lists and tuples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Iteration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/intro_to_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Introduction to functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/string_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">String methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/dictionaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Dictionaries</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/comprehensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Comprehensions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/packages_and_modules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Packages and modules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/exceptions_and_error_handling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Errors and exception handling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/file_io.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">File I/O</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../appendices/python_basics/intro_to_numpy_and_scipy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">P</span>&nbsp; <span class="chapter-title">Introduction to Numpy and Scipy</span></span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">In this section</h2>
   
  <ul>
  <li><a href="#the-data-set" id="toc-the-data-set" class="nav-link active" data-scroll-target="#the-data-set"><span class="header-section-number">2.1</span> The data set</a></li>
  <li><a href="#data-frames" id="toc-data-frames" class="nav-link" data-scroll-target="#data-frames"><span class="header-section-number">2.2</span> Data frames</a>
  <ul class="collapse">
  <li><a href="#pandas" id="toc-pandas" class="nav-link" data-scroll-target="#pandas"><span class="header-section-number">2.2.1</span> Pandas</a></li>
  </ul></li>
  <li><a href="#loading-the-data" id="toc-loading-the-data" class="nav-link" data-scroll-target="#loading-the-data"><span class="header-section-number">2.3</span> Loading the data</a>
  <ul class="collapse">
  <li><a href="#using-polars.read_csv-to-read-in-data" id="toc-using-polars.read_csv-to-read-in-data" class="nav-link" data-scroll-target="#using-polars.read_csv-to-read-in-data"><span class="header-section-number">2.3.1</span> Using polars.read_csv() to read in data</a></li>
  </ul></li>
  <li><a href="#exploring-the-dataframe" id="toc-exploring-the-dataframe" class="nav-link" data-scroll-target="#exploring-the-dataframe"><span class="header-section-number">2.4</span> Exploring the DataFrame</a></li>
  <li><a href="#indexing-data-frames" id="toc-indexing-data-frames" class="nav-link" data-scroll-target="#indexing-data-frames"><span class="header-section-number">2.5</span> Indexing data frames</a></li>
  <li><a href="#boolean-indexing-of-data-frames" id="toc-boolean-indexing-of-data-frames" class="nav-link" data-scroll-target="#boolean-indexing-of-data-frames"><span class="header-section-number">2.6</span> Boolean indexing of data frames</a></li>
  <li><a href="#contexts-and-expressions" id="toc-contexts-and-expressions" class="nav-link" data-scroll-target="#contexts-and-expressions"><span class="header-section-number">2.7</span> Contexts and expressions</a>
  <ul class="collapse">
  <li><a href="#the-filter-context" id="toc-the-filter-context" class="nav-link" data-scroll-target="#the-filter-context"><span class="header-section-number">2.7.1</span> The filter context</a></li>
  <li><a href="#the-selection-context" id="toc-the-selection-context" class="nav-link" data-scroll-target="#the-selection-context"><span class="header-section-number">2.7.2</span> The selection context</a></li>
  </ul></li>
  <li><a href="#polars-selectors" id="toc-polars-selectors" class="nav-link" data-scroll-target="#polars-selectors"><span class="header-section-number">2.8</span> Polars selectors</a></li>
  <li><a href="#computing-summary-statistics" id="toc-computing-summary-statistics" class="nav-link" data-scroll-target="#computing-summary-statistics"><span class="header-section-number">2.9</span> Computing summary statistics</a>
  <ul class="collapse">
  <li><a href="#outputting-a-new-csv-file" id="toc-outputting-a-new-csv-file" class="nav-link" data-scroll-target="#outputting-a-new-csv-file"><span class="header-section-number">2.9.1</span> Outputting a new CSV file</a></li>
  </ul></li>
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns"><span class="header-section-number">2.10</span> Renaming columns</a></li>
  <li><a href="#a-note-on-indexing-and-speed" id="toc-a-note-on-indexing-and-speed" class="nav-link" data-scroll-target="#a-note-on-indexing-and-speed"><span class="header-section-number">2.11</span> A note on indexing and speed</a></li>
  <li><a href="#computing-environment" id="toc-computing-environment" class="nav-link" data-scroll-target="#computing-environment"><span class="header-section-number">2.12</span> Computing environment</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../lessons/eda/exploratory_data_analysis.html">Exploratory data analysis</a></li><li class="breadcrumb-item"><a href="../../../lessons/eda/polars/intro_to_polars.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to data frames and Polars</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-intro-to-polars" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to data frames and Polars</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="https://colab.research.google.com/github/bebi103a/bebi103a_notebooks_2025/blob/main/intro_to_polars.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open in Google Colab" title="Open in Google Colab"></a> | <a href="https://raw.githubusercontent.com/bebi103a/bebi103a_notebooks_2025/refs/heads/main/intro_to_polars.ipynb">Download notebook</a></p>
<p><a href="https://s3.amazonaws.com/bebi103.caltech.edu/data/gfmt_sleep.csv">Data set download</a></p>
<hr>
<div id="cell-1" class="cell" data-nbsphinx="hidden" data-tags="[]" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colab setup ------------------</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os, sys, subprocess</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"google.colab"</span> <span class="kw">in</span> sys.modules:</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    cmd <span class="op">=</span> <span class="st">"pip install --upgrade polars watermark"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    process <span class="op">=</span> subprocess.Popen(cmd.split(), stdout<span class="op">=</span>subprocess.PIPE, stderr<span class="op">=</span>subprocess.PIPE)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    stdout, stderr <span class="op">=</span> process.communicate()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    data_path <span class="op">=</span> <span class="st">"https://s3.amazonaws.com/bebi103.caltech.edu/data/"</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    data_path <span class="op">=</span> <span class="st">"../data/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Polars, conventionally imported as pl</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># A subset of Polars  used for selecting columns</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars.selectors <span class="im">as</span> cs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Throughout your research career, you will undoubtedly need to handle data, possibly lots of data. Once in a usable form, you are empowered to rapidly make graphics and perform statistical inference. <strong>Tidy data</strong> is an important format and we will discuss that in subsequent sections of this lesson. In an ideal world, data sets would be stored in tidy format and be ready to use. The data comes in lots of formats, and you may have to spend much of your time <strong>wrangling</strong> the data to get it into a usable format. Wrangling is the topic of the next lesson; for now all data sets will be in tidy format from the get-go.</p>
<section id="the-data-set" class="level2 page-columns page-full" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-data-set"><span class="header-section-number">2.1</span> The data set</h2>
<p>We will explore using data frames with a real data set. We will use a data set published in <a href="https://doi.org/10.1098/rsos.160321">Beattie, et al., Perceptual impairment in face identification with poor sleep, <em>Royal Society Open Science</em>, <strong>3</strong>, 160321, 2016</a>. In this paper, researchers used the <a href="https://doi.org/10.3758/BRM.42.1.286">Glasgow Facial Matching Test</a> (GMFT) to investigate how sleep deprivation affects a subject’s ability to match faces, as well as the confidence the subject has in those matches. Briefly, the test works by having subjects look at a pair of faces. Two such pairs are shown below.</p>
<div id="fig-gfmt-faces" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" alt="GFMT faces">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-gfmt-faces-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gfmt_faces.png" class="img-fluid figure-img" style="width:60.0%" alt="GFMT faces">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-gfmt-faces-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Two pairs of faces from the Glasgow Facial Matching Test (GFMT).
</figcaption>
</figure>
</div>
<p>The top two pictures are the same person, the bottom two pictures are different people. For each pair of faces, the subject gets as much time as he or she needs and then says whether or not they are the same person. The subject then rates his or her confidence in the choice.</p>
<p>In this study, subjects also took surveys to determine properties about their sleep. The Sleep Condition Indicator (SCI) is a measure of insomnia disorder over the past month (scores of 16 and below indicate insomnia). The Pittsburgh Sleep Quality Index (PSQI) quantifies how well a subject sleeps in terms of interruptions, latency, etc. A higher score indicates poorer sleep. The Epworth Sleepiness Scale (ESS) assesses daytime drowsiness.</p>
<p>The data set can be downloaded <a href="https://s3.amazonaws.com/bebi103.caltech.edu/data/gfmt_sleep.csv">here</a>. The contents of this file were adapted from <a href="https://doi.org/10.5061/dryad.r620r">the Excel file posted on the public Dryad repository</a>. (<em>Note this: if you want other people to use and explore your data, make it publicly available.</em>) I’ll say it more boldly.</p>
<div class="alert alert-info">
<p>If at all possible, share your data freely.</p>
</div>
<p>The data file is a <strong>CSV file</strong>, where CSV stands for comma-separated value. This is a text file that is easily read into data structures in many programming languages. You should generally always store your data in such a format, not necessarily CSV, but a format that is open, has a well-defined specification, and is readable in many contexts. Excel files do not meet these criteria. Neither do <code>.mat</code> files. There are other good ways to store data, such as <a href="http://json.org">JSON</a>, but we will almost exclusively use CSV files in this class.</p>
<p>Let’s take a look at the CSV file. We will use the command line program <code>head</code> to look at the first 20 lines of the file.</p>
<div id="cell-5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> os.path.join(data_path, <span class="st">"gfmt_sleep.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This will not work in Colab because the file is not local</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>head {fname}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>﻿participant number,gender,age,correct hit percentage,correct reject percentage,percent correct,confidence when correct hit,confidence incorrect hit,confidence correct reject,confidence incorrect reject,confidence when correct,confidence when incorrect,sci,psqi,ess
8,f,39,65,80,72.5,91,90,93,83.5,93,90,9,13,2
16,m,42,90,90,90,75.5,55.5,70.5,50,75,50,4,11,7
18,f,31,90,95,92.5,89.5,90,86,81,89,88,10,9,3
22,f,35,100,75,87.5,89.5,*,71,80,88,80,13,8,20
27,f,74,60,65,62.5,68.5,49,61,49,65,49,13,9,12
28,f,61,80,20,50,71,63,31,72.5,64.5,70.5,15,14,2
30,m,32,90,75,82.5,67,56.5,66,65,66,64,16,9,3
33,m,62,45,90,67.5,54,37,65,81.5,62,61,14,9,9
34,f,33,80,100,90,70.5,76.5,64.5,*,68,76.5,14,12,10</code></pre>
</div>
</div>
<p>The first line contains the <strong>headers</strong> for each column. They are participant number, gender, age, etc. The data follow. There are two important things to note here. First, notice that the <code>gender</code> column has string data (<code>m</code> or <code>f</code>), while the rest of the data are numeric. Note also that there are some <strong>missing data</strong>, denoted by the <code>*</code>s in the file.</p>
<p>Given the file I/O skills you recently learned, you could write some functions to parse this file and extract the data you want. You can imagine that this might be kind of painful. However, if the file format is nice and clean, like we more or less have here, we can use pre-built tools to read in the data from the file and put it in a convenient data structure. Those structures are <strong>data frames</strong>.</p>
</section>
<section id="data-frames" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="data-frames"><span class="header-section-number">2.2</span> Data frames</h2>
<p>Though we will use the word “data frame” over and over again, what a data frame <em>is</em> is actually a bit nebulous. Our working definition of a data frame is that it is a representation of two-dimensional tabular data where each column has a label. We will restrict ourselves to the case where each column has a specific data type (e.g., strings, ints, floats, or even lists).</p>
<p>One can think of a data frame as a collection of labeled columns, each one called a <strong>series</strong>. (A series may be thought of as a single column of data.) Alternatively, it is sometimes convenient to think of a data frame as a collection of <strong>rows</strong>, where each entry in the row is labeled with the column heading.</p>
<p>For more reading on the history of data frames and an attempt (in my opinion a very good attempt) at clearly defining them see section 4 of <a href="https://dl.acm.org/doi/10.14778/3407790.3407807">this paper by Petersohn, et al</a>.</p>
<section id="pandas" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="pandas"><span class="header-section-number">2.2.1</span> Pandas</h3>
<p><a href="https://pandas.pydata.org">Pandas</a> is one of the most widely used tools in the Python ecosystem for handling data. It is worth knowing about. We will, however, not be using Pandas, but instead will use <a href="https://pola.rs">Polars</a>. I prefer Polars because its API is cleaner, in my opinion, but it has the added benefit of generally being much faster than Pandas.</p>
</section>
</section>
<section id="loading-the-data" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="loading-the-data"><span class="header-section-number">2.3</span> Loading the data</h2>
<section id="using-polars.read_csv-to-read-in-data" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="using-polars.read_csv-to-read-in-data"><span class="header-section-number">2.3.1</span> Using polars.read_csv() to read in data</h3>
<p>We have imported Polars with the alias <code>pl</code> as is customary. We will use <code>pl.read_csv()</code> to load the data set. The data are stored in a <strong>data frame</strong> (data type <code>DataFrame</code>), which is one of the data types that makes Polars so convenient for use in data analysis. Data frames offer mixed data types, including incomplete columns, and convenient slicing, among many, many other convenient features. We will use the data frame to look at the data, at the same time demonstrating some of the power of data frames. They are like spreadsheets, only a lot better.</p>
<div id="cell-11" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_csv(fname, null_values<span class="op">=</span><span class="st">"*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that we used the kwarg <code>null_values=*</code> to specify that entries marked with a <code>*</code> are missing. The resulting data frame is populated with <strong>null</strong>, wherever this character is present in the file. In this case, we want <code>null_values='*'</code>. So, let’s load in the data set.</p>
<p>If you check out the doc string for <code>pl.read_csv()</code>, you will see there are <em>lots</em> of options for reading in the data.</p>
</section>
</section>
<section id="exploring-the-dataframe" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="exploring-the-dataframe"><span class="header-section-number">2.4</span> Exploring the DataFrame</h2>
<p>Let’s jump right in and look at the contents of the <code>DataFrame</code>. We can look at the first several rows using the <code>df.head()</code> method.</p>
<div id="cell-14" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the contents (first 5 rows)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td>"f"</td>
<td>39</td>
<td>65</td>
<td>80</td>
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
<td>9</td>
<td>13</td>
<td>2</td>
</tr>
<tr class="even">
<td>16</td>
<td>"m"</td>
<td>42</td>
<td>90</td>
<td>90</td>
<td>90.0</td>
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
<td>4</td>
<td>11</td>
<td>7</td>
</tr>
<tr class="odd">
<td>18</td>
<td>"f"</td>
<td>31</td>
<td>90</td>
<td>95</td>
<td>92.5</td>
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
<td>10</td>
<td>9</td>
<td>3</td>
</tr>
<tr class="even">
<td>22</td>
<td>"f"</td>
<td>35</td>
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
<td>13</td>
<td>8</td>
<td>20</td>
</tr>
<tr class="odd">
<td>27</td>
<td>"f"</td>
<td>74</td>
<td>60</td>
<td>65</td>
<td>62.5</td>
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
<td>13</td>
<td>9</td>
<td>12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We see that the column headings were automatically assigned, as have the data types of the columns, where <code>i64</code>, <code>f64</code>, and <code>str</code> respectively denote integers, floats and strings. Also note (in row 3) that the missing data are denoted as <code>null</code>.</p>
</section>
<section id="indexing-data-frames" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="indexing-data-frames"><span class="header-section-number">2.5</span> Indexing data frames</h2>
<p>The data frame is a convenient data structure for many reasons that will become clear as we start exploring. Let’s start by looking at how data frames are indexed. The rows in Polars data frames are indexed by integers, starting with zero as usual for Python. So, the first row of the data frame may be accessed as follows.</p>
<div id="cell-17" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td>"f"</td>
<td>39</td>
<td>65</td>
<td>80</td>
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
<td>9</td>
<td>13</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In practice you will almost never use row indices, but rather use <strong>Boolean indexing</strong>, which is accomplished using Polars’s <code>filter()</code> method.</p>
<p>Because row indices in Polars data frames are always integers and column indices are not allowed to be integers (they must be strings), columns are accessed in the same way. If you choose to index with a string, Polars knows you are asking for a column.</p>
<div id="cell-19" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'percent correct'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (102,)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">percent correct</th>
</tr>
<tr class="even">
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>72.5</td>
</tr>
<tr class="even">
<td>90.0</td>
</tr>
<tr class="odd">
<td>92.5</td>
</tr>
<tr class="even">
<td>87.5</td>
</tr>
<tr class="odd">
<td>62.5</td>
</tr>
<tr class="even">
<td>…</td>
</tr>
<tr class="odd">
<td>77.5</td>
</tr>
<tr class="even">
<td>87.5</td>
</tr>
<tr class="odd">
<td>75.0</td>
</tr>
<tr class="even">
<td>70.0</td>
</tr>
<tr class="odd">
<td>62.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>For accessing a single column, I prefer the <code>get_column()</code> method.</p>
<div id="cell-21" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df.get_column(<span class="st">'percent correct'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (102,)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">percent correct</th>
</tr>
<tr class="even">
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>72.5</td>
</tr>
<tr class="even">
<td>90.0</td>
</tr>
<tr class="odd">
<td>92.5</td>
</tr>
<tr class="even">
<td>87.5</td>
</tr>
<tr class="odd">
<td>62.5</td>
</tr>
<tr class="even">
<td>…</td>
</tr>
<tr class="odd">
<td>77.5</td>
</tr>
<tr class="even">
<td>87.5</td>
</tr>
<tr class="odd">
<td>75.0</td>
</tr>
<tr class="even">
<td>70.0</td>
</tr>
<tr class="odd">
<td>62.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="boolean-indexing-of-data-frames" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="boolean-indexing-of-data-frames"><span class="header-section-number">2.6</span> Boolean indexing of data frames</h2>
<p>Let’s say I wanted the record for participant number 42. I can use Boolean indexing to specify the row. This is accomplished using the <code>filter()</code> method.</p>
<div id="cell-23" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">filter</span>(pl.col(<span class="st">"participant number"</span>) <span class="op">==</span> <span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>42</td>
<td>"m"</td>
<td>29</td>
<td>100</td>
<td>70</td>
<td>85.0</td>
<td>75.0</td>
<td>null</td>
<td>64.5</td>
<td>43.0</td>
<td>74.0</td>
<td>43.0</td>
<td>32</td>
<td>1</td>
<td>6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The argument of the <code>filter()</code> method is an <strong>expression</strong>, <code>pl.col('participant number') == 42</code>, which gives the rows (in this case, one row) for which the value of the <code>'participant number'</code> column is 42.</p>
<p>If I just wanted the percent correct, I can first filter to get the row I want, then extract the <code>'percent correct'</code> column, and then use the <code>item()</code> method to extract the scalar value.</p>
<div id="cell-25" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(pl.col(<span class="st">'participant number'</span>) <span class="op">==</span> <span class="dv">42</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    .get_column(<span class="st">'percent correct'</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    .item()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>85.0</code></pre>
</div>
</div>
<p>Note how I expressed this code snippet stylistically. I am doing method chaining, and having each method on its own line adds readability.</p>
<p>Now, let’s pull out all records of females under the age of 21. We can again use Boolean indexing, but we need to use an <code>&amp;</code> operator, taken to mean logical AND. We did not cover this bitwise operator before, but the syntax is self-explanatory in the example below. Note that it is important that each Boolean operation you are doing is in parentheses because of the precedence of the operators involved. The other bitwise operators you may wish to use for Boolean indexing in data frames are <code>|</code> for OR and <code>~</code> for NOT.</p>
<div id="cell-27" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">filter</span>((pl.col(<span class="st">'gender'</span>) <span class="op">==</span> <span class="st">'f'</span>) <span class="op">&amp;</span> (pl.col(<span class="st">'age'</span>) <span class="op">&lt;</span> <span class="dv">21</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>"f"</td>
<td>16</td>
<td>70</td>
<td>80</td>
<td>75.0</td>
<td>70.0</td>
<td>57.0</td>
<td>54.0</td>
<td>53.0</td>
<td>57.0</td>
<td>54.5</td>
<td>23</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td>5</td>
<td>"f"</td>
<td>18</td>
<td>90</td>
<td>100</td>
<td>95.0</td>
<td>76.5</td>
<td>83.0</td>
<td>80.0</td>
<td>null</td>
<td>80.0</td>
<td>83.0</td>
<td>21</td>
<td>7</td>
<td>5</td>
</tr>
<tr class="odd">
<td>58</td>
<td>"f"</td>
<td>16</td>
<td>85</td>
<td>85</td>
<td>85.0</td>
<td>55.0</td>
<td>30.0</td>
<td>50.0</td>
<td>40.0</td>
<td>52.5</td>
<td>35.0</td>
<td>29</td>
<td>2</td>
<td>11</td>
</tr>
<tr class="even">
<td>72</td>
<td>"f"</td>
<td>18</td>
<td>80</td>
<td>75</td>
<td>77.5</td>
<td>67.5</td>
<td>51.5</td>
<td>66.0</td>
<td>57.0</td>
<td>67.0</td>
<td>53.0</td>
<td>29</td>
<td>4</td>
<td>6</td>
</tr>
<tr class="odd">
<td>85</td>
<td>"f"</td>
<td>18</td>
<td>85</td>
<td>85</td>
<td>85.0</td>
<td>93.0</td>
<td>92.0</td>
<td>91.0</td>
<td>89.0</td>
<td>91.5</td>
<td>91.0</td>
<td>25</td>
<td>4</td>
<td>21</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can do something even more complicated, like pull out all females under 30 who got more than 85% of the face matching tasks correct.</p>
<div id="cell-29" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">filter</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>      (pl.col(<span class="st">'gender'</span>) <span class="op">==</span> <span class="st">'f'</span>) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (pl.col(<span class="st">'age'</span>) <span class="op">&lt;</span> <span class="dv">30</span>) </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (pl.col(<span class="st">'percent correct'</span>) <span class="op">&gt;</span> <span class="fl">85.0</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (8, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>93</td>
<td>"f"</td>
<td>28</td>
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>67.0</td>
<td>60.0</td>
<td>80.0</td>
<td>60.0</td>
<td>16</td>
<td>7</td>
<td>4</td>
</tr>
<tr class="even">
<td>5</td>
<td>"f"</td>
<td>18</td>
<td>90</td>
<td>100</td>
<td>95.0</td>
<td>76.5</td>
<td>83.0</td>
<td>80.0</td>
<td>null</td>
<td>80.0</td>
<td>83.0</td>
<td>21</td>
<td>7</td>
<td>5</td>
</tr>
<tr class="odd">
<td>6</td>
<td>"f"</td>
<td>28</td>
<td>95</td>
<td>80</td>
<td>87.5</td>
<td>100.0</td>
<td>85.0</td>
<td>94.0</td>
<td>61.0</td>
<td>99.0</td>
<td>65.0</td>
<td>19</td>
<td>7</td>
<td>12</td>
</tr>
<tr class="even">
<td>10</td>
<td>"f"</td>
<td>25</td>
<td>100</td>
<td>100</td>
<td>100.0</td>
<td>90.0</td>
<td>null</td>
<td>85.0</td>
<td>null</td>
<td>90.0</td>
<td>null</td>
<td>17</td>
<td>10</td>
<td>11</td>
</tr>
<tr class="odd">
<td>44</td>
<td>"f"</td>
<td>21</td>
<td>85</td>
<td>90</td>
<td>87.5</td>
<td>66.0</td>
<td>29.0</td>
<td>70.0</td>
<td>29.0</td>
<td>67.0</td>
<td>29.0</td>
<td>26</td>
<td>7</td>
<td>18</td>
</tr>
<tr class="even">
<td>48</td>
<td>"f"</td>
<td>23</td>
<td>90</td>
<td>85</td>
<td>87.5</td>
<td>67.0</td>
<td>47.0</td>
<td>69.0</td>
<td>40.0</td>
<td>67.0</td>
<td>40.0</td>
<td>18</td>
<td>6</td>
<td>8</td>
</tr>
<tr class="odd">
<td>51</td>
<td>"f"</td>
<td>24</td>
<td>85</td>
<td>95</td>
<td>90.0</td>
<td>97.0</td>
<td>41.0</td>
<td>74.0</td>
<td>73.0</td>
<td>83.0</td>
<td>55.5</td>
<td>29</td>
<td>1</td>
<td>7</td>
</tr>
<tr class="even">
<td>67</td>
<td>"f"</td>
<td>25</td>
<td>100</td>
<td>100</td>
<td>100.0</td>
<td>61.5</td>
<td>null</td>
<td>58.5</td>
<td>null</td>
<td>60.5</td>
<td>null</td>
<td>28</td>
<td>8</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Of interest in this exercise in Boolean indexing is that we never had to write a loop. To produce our indices, we could have done the following.</p>
<div id="cell-31" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize array of Boolean indices</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>inds <span class="op">=</span> []</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the rows of the DataFrame to check if the row should be included</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> df.iter_rows(named<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    inds.append(    </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>            row[<span class="st">"age"</span>] <span class="op">&lt;</span> <span class="dv">30</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">and</span> row[<span class="st">"gender"</span>] <span class="op">==</span> <span class="st">"f"</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">and</span> row[<span class="st">"percent correct"</span>] <span class="op">&gt;</span> <span class="dv">85</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at inds</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, True, False, False, False, False, False, False, True, True, False, False, True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, True, False, True, False, True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False]</code></pre>
</div>
</div>
<p>If we wanted, we could use this <code>inds</code> list of <code>True</code>s and <code>False</code>s to filter our values.</p>
<div id="cell-33" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">filter</span>(inds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (8, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>93</td>
<td>"f"</td>
<td>28</td>
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>67.0</td>
<td>60.0</td>
<td>80.0</td>
<td>60.0</td>
<td>16</td>
<td>7</td>
<td>4</td>
</tr>
<tr class="even">
<td>5</td>
<td>"f"</td>
<td>18</td>
<td>90</td>
<td>100</td>
<td>95.0</td>
<td>76.5</td>
<td>83.0</td>
<td>80.0</td>
<td>null</td>
<td>80.0</td>
<td>83.0</td>
<td>21</td>
<td>7</td>
<td>5</td>
</tr>
<tr class="odd">
<td>6</td>
<td>"f"</td>
<td>28</td>
<td>95</td>
<td>80</td>
<td>87.5</td>
<td>100.0</td>
<td>85.0</td>
<td>94.0</td>
<td>61.0</td>
<td>99.0</td>
<td>65.0</td>
<td>19</td>
<td>7</td>
<td>12</td>
</tr>
<tr class="even">
<td>10</td>
<td>"f"</td>
<td>25</td>
<td>100</td>
<td>100</td>
<td>100.0</td>
<td>90.0</td>
<td>null</td>
<td>85.0</td>
<td>null</td>
<td>90.0</td>
<td>null</td>
<td>17</td>
<td>10</td>
<td>11</td>
</tr>
<tr class="odd">
<td>44</td>
<td>"f"</td>
<td>21</td>
<td>85</td>
<td>90</td>
<td>87.5</td>
<td>66.0</td>
<td>29.0</td>
<td>70.0</td>
<td>29.0</td>
<td>67.0</td>
<td>29.0</td>
<td>26</td>
<td>7</td>
<td>18</td>
</tr>
<tr class="even">
<td>48</td>
<td>"f"</td>
<td>23</td>
<td>90</td>
<td>85</td>
<td>87.5</td>
<td>67.0</td>
<td>47.0</td>
<td>69.0</td>
<td>40.0</td>
<td>67.0</td>
<td>40.0</td>
<td>18</td>
<td>6</td>
<td>8</td>
</tr>
<tr class="odd">
<td>51</td>
<td>"f"</td>
<td>24</td>
<td>85</td>
<td>95</td>
<td>90.0</td>
<td>97.0</td>
<td>41.0</td>
<td>74.0</td>
<td>73.0</td>
<td>83.0</td>
<td>55.5</td>
<td>29</td>
<td>1</td>
<td>7</td>
</tr>
<tr class="even">
<td>67</td>
<td>"f"</td>
<td>25</td>
<td>100</td>
<td>100</td>
<td>100.0</td>
<td>61.5</td>
<td>null</td>
<td>58.5</td>
<td>null</td>
<td>60.5</td>
<td>null</td>
<td>28</td>
<td>8</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This feature, where the looping is done automatically on Polars objects like data frames, is very powerful and saves us writing lots of lines of code. This example also showed how to use the <code>iter_rows()</code> method of a data frame. It is actually rare that you will need to do that, and you should generally avoid it, since it is also slow.</p>
</section>
<section id="contexts-and-expressions" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="contexts-and-expressions"><span class="header-section-number">2.7</span> Contexts and expressions</h2>
<p>We will now be a bit more formal in discussing how to work with Polars data frames. Specifically, Polars features the concepts of <strong>expressions</strong> and <strong>contexts</strong>.</p>
<section id="the-filter-context" class="level3" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="the-filter-context"><span class="header-section-number">2.7.1</span> The filter context</h3>
<p>As an example, let us consider our above task of filtering the data frame to extract females under the age of 21. The syntax was</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">filter</span>((pl.col(<span class="st">'gender'</span>) <span class="op">==</span> <span class="st">'f'</span>) <span class="op">&amp;</span> (pl.col(<span class="st">'age'</span>) <span class="op">&lt;</span> <span class="dv">21</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Consider first <code>pl.col('gender') == 'f'</code>. This is an example of an expression. An expression consists of a calculation or transformation that can be applied to a series and returns a series. In this case, we are taking a column called <code>'gender'</code> and we are evaluating whether each element in that column is <code>'f'</code>. Indeed, if we ask the Python interpreter to tell us the type of the above expression, it is a Polars <code>Expr</code>.</p>
<div id="cell-37" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(pl.col(<span class="st">'gender'</span>) <span class="op">==</span> <span class="st">'f'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>polars.expr.expr.Expr</code></pre>
</div>
</div>
<p>Similarly, <code>pl.col('age') &lt; 21</code> is also an expression, as is the result when we apply the <code>&amp;</code> bitwise operator.</p>
<div id="cell-39" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>((pl.col(<span class="st">'gender'</span>) <span class="op">==</span> <span class="st">'f'</span>) <span class="op">&amp;</span> (pl.col(<span class="st">'age'</span>) <span class="op">&lt;</span> <span class="dv">21</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>polars.expr.expr.Expr</code></pre>
</div>
</div>
<p>So, an expression says what we want to <em>do</em> to data. But now we ask, in what way, i.e., in what <em>context</em>, do we want to <em>use</em> the result of the expression? One way we may wish to use the above expression is to filter the rows in a data frame. The <strong>filter context</strong> is established by <code>df.filter()</code>. The argument of <code>df.filter()</code> is an expression (or expressions) that evaluate to Booleans. That is how we got our result; in the context of filtering, the expression is evaluated and only entries where the expression gives <code>True</code> are retained.</p>
<div id="cell-41" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">filter</span>((pl.col(<span class="st">'gender'</span>) <span class="op">==</span> <span class="st">'f'</span>) <span class="op">&amp;</span> (pl.col(<span class="st">'age'</span>) <span class="op">&lt;</span> <span class="dv">21</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>"f"</td>
<td>16</td>
<td>70</td>
<td>80</td>
<td>75.0</td>
<td>70.0</td>
<td>57.0</td>
<td>54.0</td>
<td>53.0</td>
<td>57.0</td>
<td>54.5</td>
<td>23</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td>5</td>
<td>"f"</td>
<td>18</td>
<td>90</td>
<td>100</td>
<td>95.0</td>
<td>76.5</td>
<td>83.0</td>
<td>80.0</td>
<td>null</td>
<td>80.0</td>
<td>83.0</td>
<td>21</td>
<td>7</td>
<td>5</td>
</tr>
<tr class="odd">
<td>58</td>
<td>"f"</td>
<td>16</td>
<td>85</td>
<td>85</td>
<td>85.0</td>
<td>55.0</td>
<td>30.0</td>
<td>50.0</td>
<td>40.0</td>
<td>52.5</td>
<td>35.0</td>
<td>29</td>
<td>2</td>
<td>11</td>
</tr>
<tr class="even">
<td>72</td>
<td>"f"</td>
<td>18</td>
<td>80</td>
<td>75</td>
<td>77.5</td>
<td>67.5</td>
<td>51.5</td>
<td>66.0</td>
<td>57.0</td>
<td>67.0</td>
<td>53.0</td>
<td>29</td>
<td>4</td>
<td>6</td>
</tr>
<tr class="odd">
<td>85</td>
<td>"f"</td>
<td>18</td>
<td>85</td>
<td>85</td>
<td>85.0</td>
<td>93.0</td>
<td>92.0</td>
<td>91.0</td>
<td>89.0</td>
<td>91.5</td>
<td>91.0</td>
<td>25</td>
<td>4</td>
<td>21</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="the-selection-context" class="level3" data-number="2.7.2">
<h3 data-number="2.7.2" class="anchored" data-anchor-id="the-selection-context"><span class="header-section-number">2.7.2</span> The selection context</h3>
<p>The simplest way we can use an expression is simply to evaluate the expression and give its result as a new data frame. This is the <strong>selection</strong> context, in which we get the output of the expression. It can be invoked with <code>df.select()</code>.</p>
<div id="cell-43" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.select((pl.col(<span class="st">'gender'</span>) <span class="op">==</span> <span class="st">'f'</span>) <span class="op">&amp;</span> (pl.col(<span class="st">'age'</span>) <span class="op">&lt;</span> <span class="dv">21</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (102, 1)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">gender</th>
</tr>
<tr class="even">
<th>bool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>…</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Note that this is a data frame and not a series; it is a data frame containing one column. In this case, the column is named after the first column used in our Boolean expression. We can adjust the column label by applying the <code>alias()</code> method, which does a renaming transformation.</p>
<div id="cell-45" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>f_under_21 <span class="op">=</span> (pl.col(<span class="st">'gender'</span>) <span class="op">==</span> <span class="st">'f'</span>) <span class="op">&amp;</span> (pl.col(<span class="st">'age'</span>) <span class="op">&lt;</span> <span class="dv">21</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>df.select(f_under_21.alias(<span class="st">'female under 21'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (102, 1)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">female under 21</th>
</tr>
<tr class="even">
<th>bool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>…</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>If we wanted a series instead of a new data frame, we can apply the <code>get_column()</code> method to the data frame returned by <code>df.select()</code>.</p>
<div id="cell-47" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Result of expression as a series</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df.select(f_under_21.alias(<span class="st">'female under 21'</span>)).get_column(<span class="st">'female under 21'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (102,)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">female under 21</th>
</tr>
<tr class="even">
<th>bool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>…</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can also select with multiple expressions. For example, let’s say we additionally wanted to compute the ratio of confidence when correct to confidence when incorrect. First, we can make an expression for that.</p>
<div id="cell-49" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>conf_ratio <span class="op">=</span> pl.col(<span class="st">'confidence when correct'</span>) <span class="op">/</span> pl.col(<span class="st">'confidence when incorrect'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can select that as well as the <code>'female under 21'</code> column.</p>
<div id="cell-51" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df.select(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    f_under_21.alias(<span class="st">'female under 21'</span>),</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    conf_ratio.alias(<span class="st">'confidence ratio'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (102, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">female under 21</th>
<th data-quarto-table-cell-role="th">confidence ratio</th>
</tr>
<tr class="even">
<th>bool</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>false</td>
<td>1.033333</td>
</tr>
<tr class="even">
<td>false</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td>false</td>
<td>1.011364</td>
</tr>
<tr class="even">
<td>false</td>
<td>1.1</td>
</tr>
<tr class="odd">
<td>false</td>
<td>1.326531</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>false</td>
<td>1.040541</td>
</tr>
<tr class="even">
<td>false</td>
<td>0.925</td>
</tr>
<tr class="odd">
<td>false</td>
<td>0.802469</td>
</tr>
<tr class="even">
<td>false</td>
<td>1.588235</td>
</tr>
<tr class="odd">
<td>false</td>
<td>1.109589</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Notice that <code>df.select()</code> returns a new data frame containing only the columns that are given by the expressions and the original data frame is discarded. If we want the results of the expressions to instead be added to the data frame (keeping all of its original columns), we use the <code>df.with_columns()</code> method. This is still a selection context; the output is just different, comprising of the original data frame with added columns. (In the output of the cell below, you will find the columns added to the far right of the data frame.)</p>
<div id="cell-53" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df.with_columns(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    f_under_21.alias(<span class="st">'female under 21'</span>),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    conf_ratio.alias(<span class="st">'confidence ratio'</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (102, 17)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
<th data-quarto-table-cell-role="th">female under 21</th>
<th data-quarto-table-cell-role="th">confidence ratio</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>bool</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td>"f"</td>
<td>39</td>
<td>65</td>
<td>80</td>
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
<td>9</td>
<td>13</td>
<td>2</td>
<td>false</td>
<td>1.033333</td>
</tr>
<tr class="even">
<td>16</td>
<td>"m"</td>
<td>42</td>
<td>90</td>
<td>90</td>
<td>90.0</td>
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
<td>4</td>
<td>11</td>
<td>7</td>
<td>false</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td>18</td>
<td>"f"</td>
<td>31</td>
<td>90</td>
<td>95</td>
<td>92.5</td>
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
<td>10</td>
<td>9</td>
<td>3</td>
<td>false</td>
<td>1.011364</td>
</tr>
<tr class="even">
<td>22</td>
<td>"f"</td>
<td>35</td>
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
<td>13</td>
<td>8</td>
<td>20</td>
<td>false</td>
<td>1.1</td>
</tr>
<tr class="odd">
<td>27</td>
<td>"f"</td>
<td>74</td>
<td>60</td>
<td>65</td>
<td>62.5</td>
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
<td>13</td>
<td>9</td>
<td>12</td>
<td>false</td>
<td>1.326531</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>97</td>
<td>"f"</td>
<td>23</td>
<td>70</td>
<td>85</td>
<td>77.5</td>
<td>77.0</td>
<td>66.5</td>
<td>77.0</td>
<td>77.5</td>
<td>77.0</td>
<td>74.0</td>
<td>20</td>
<td>8</td>
<td>10</td>
<td>false</td>
<td>1.040541</td>
</tr>
<tr class="even">
<td>98</td>
<td>"f"</td>
<td>70</td>
<td>90</td>
<td>85</td>
<td>87.5</td>
<td>65.5</td>
<td>85.5</td>
<td>87.0</td>
<td>80.0</td>
<td>74.0</td>
<td>80.0</td>
<td>19</td>
<td>8</td>
<td>7</td>
<td>false</td>
<td>0.925</td>
</tr>
<tr class="odd">
<td>99</td>
<td>"f"</td>
<td>24</td>
<td>70</td>
<td>80</td>
<td>75.0</td>
<td>61.5</td>
<td>81.0</td>
<td>70.0</td>
<td>61.0</td>
<td>65.0</td>
<td>81.0</td>
<td>31</td>
<td>2</td>
<td>15</td>
<td>false</td>
<td>0.802469</td>
</tr>
<tr class="even">
<td>102</td>
<td>"f"</td>
<td>40</td>
<td>75</td>
<td>65</td>
<td>70.0</td>
<td>53.0</td>
<td>37.0</td>
<td>84.0</td>
<td>52.0</td>
<td>81.0</td>
<td>51.0</td>
<td>22</td>
<td>4</td>
<td>7</td>
<td>false</td>
<td>1.588235</td>
</tr>
<tr class="odd">
<td>103</td>
<td>"f"</td>
<td>33</td>
<td>85</td>
<td>40</td>
<td>62.5</td>
<td>80.0</td>
<td>27.0</td>
<td>31.0</td>
<td>82.5</td>
<td>81.0</td>
<td>73.0</td>
<td>24</td>
<td>5</td>
<td>7</td>
<td>false</td>
<td>1.109589</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Finally, we will do something we’ll want to use going forward. Recall that a subject is said to suffer from insomnia if he or she has an SCI of 16 or below. We might like to add a column to the data frame that specifies whether or not the subject suffers from insomnia, which we do in the code cell below. Note that until now, we have not updated our data frame. To actually update the data frame, we need an assignment operation, <code>df = ...</code>.</p>
<div id="cell-55" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column with `True` for insomnia</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.with_columns((pl.col(<span class="st">'sci'</span>) <span class="op">&lt;=</span> <span class="dv">16</span>).alias(<span class="st">'insomnia'</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look (.head() gives first five rows)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 16)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
<th data-quarto-table-cell-role="th">insomnia</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>bool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td>"f"</td>
<td>39</td>
<td>65</td>
<td>80</td>
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
<td>9</td>
<td>13</td>
<td>2</td>
<td>true</td>
</tr>
<tr class="even">
<td>16</td>
<td>"m"</td>
<td>42</td>
<td>90</td>
<td>90</td>
<td>90.0</td>
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
<td>4</td>
<td>11</td>
<td>7</td>
<td>true</td>
</tr>
<tr class="odd">
<td>18</td>
<td>"f"</td>
<td>31</td>
<td>90</td>
<td>95</td>
<td>92.5</td>
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
<td>10</td>
<td>9</td>
<td>3</td>
<td>true</td>
</tr>
<tr class="even">
<td>22</td>
<td>"f"</td>
<td>35</td>
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
<td>13</td>
<td>8</td>
<td>20</td>
<td>true</td>
</tr>
<tr class="odd">
<td>27</td>
<td>"f"</td>
<td>74</td>
<td>60</td>
<td>65</td>
<td>62.5</td>
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
<td>13</td>
<td>9</td>
<td>12</td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="polars-selectors" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="polars-selectors"><span class="header-section-number">2.8</span> Polars selectors</h2>
<p>We have seen that we can choose which columns we want to work with in expressions using <code>pl.col()</code>. Thus far, we have used a single string as an argument, but <code>pl.col()</code> is more capable than that. For example, to select three columns of interest, we can do the following.</p>
<div id="cell-57" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df.select(pl.col(<span class="st">'age'</span>, <span class="st">'gender'</span>, <span class="st">'percent correct'</span>)).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">percent correct</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>39</td>
<td>"f"</td>
<td>72.5</td>
</tr>
<tr class="even">
<td>42</td>
<td>"m"</td>
<td>90.0</td>
</tr>
<tr class="odd">
<td>31</td>
<td>"f"</td>
<td>92.5</td>
</tr>
<tr class="even">
<td>35</td>
<td>"f"</td>
<td>87.5</td>
</tr>
<tr class="odd">
<td>74</td>
<td>"f"</td>
<td>62.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can also pass regular expressions into <code>pl.col()</code>. If we want all columns, for example, we can use <code>pl.col('*')</code>. To get all columns containing the string <code>'confidence'</code>, we can use <code>pl.col('^.*confidence.*$')</code>.</p>
<p>Personally, I always struggle with regular expressions. Fortunately, Polars has powerful <strong>selectors</strong> which help specify which columns are of interest. In addition to facilitating selection based on the names of the columns, selectors allow selection based on the data type of the column as well (actually, so does <code>pl.col()</code>, but it is simplified with selectors).</p>
<p>We have to import the selectors separately, which we have done in the top cell of this notebook via <code>import polars.selectors as cs</code>. The <code>cs</code> alias is suggested by the Polars developers.</p>
<p>As an example, we can select all columns that have a column heading containing the string <code>'confidence'</code>.</p>
<div id="cell-59" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df.select(cs.contains(<span class="st">'confidence'</span>)).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
</tr>
<tr class="even">
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
</tr>
<tr class="even">
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
</tr>
<tr class="odd">
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
</tr>
<tr class="even">
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
</tr>
<tr class="odd">
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Or, perhaps we want to exclude all columns that are not indicators of performance on a test (participant number, age, and gender). We can specifically exclude columns with <code>cs.exclude()</code>.</p>
<div id="cell-61" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df.select(cs.exclude(<span class="st">'gender'</span>, <span class="st">'age'</span>, <span class="st">'participant number'</span>)).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 13)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
<th data-quarto-table-cell-role="th">insomnia</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>bool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>65</td>
<td>80</td>
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
<td>9</td>
<td>13</td>
<td>2</td>
<td>true</td>
</tr>
<tr class="even">
<td>90</td>
<td>90</td>
<td>90.0</td>
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
<td>4</td>
<td>11</td>
<td>7</td>
<td>true</td>
</tr>
<tr class="odd">
<td>90</td>
<td>95</td>
<td>92.5</td>
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
<td>10</td>
<td>9</td>
<td>3</td>
<td>true</td>
</tr>
<tr class="even">
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
<td>13</td>
<td>8</td>
<td>20</td>
<td>true</td>
</tr>
<tr class="odd">
<td>60</td>
<td>65</td>
<td>62.5</td>
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
<td>13</td>
<td>9</td>
<td>12</td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>What if we want columns with only a float data type?</p>
<div id="cell-63" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df.select(cs.<span class="bu">float</span>()).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 7)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
</tr>
<tr class="even">
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
</tr>
<tr class="even">
<td>90.0</td>
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
</tr>
<tr class="odd">
<td>92.5</td>
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
</tr>
<tr class="even">
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
</tr>
<tr class="odd">
<td>62.5</td>
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Note that the sleep measures were omitted because they are integer data types. We could select everything that is numeric if we want to include those.</p>
<div id="cell-65" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df.select(cs.numeric()).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 14)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td>39</td>
<td>65</td>
<td>80</td>
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
<td>9</td>
<td>13</td>
<td>2</td>
</tr>
<tr class="even">
<td>16</td>
<td>42</td>
<td>90</td>
<td>90</td>
<td>90.0</td>
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
<td>4</td>
<td>11</td>
<td>7</td>
</tr>
<tr class="odd">
<td>18</td>
<td>31</td>
<td>90</td>
<td>95</td>
<td>92.5</td>
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
<td>10</td>
<td>9</td>
<td>3</td>
</tr>
<tr class="even">
<td>22</td>
<td>35</td>
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
<td>13</td>
<td>8</td>
<td>20</td>
</tr>
<tr class="odd">
<td>27</td>
<td>74</td>
<td>60</td>
<td>65</td>
<td>62.5</td>
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
<td>13</td>
<td>9</td>
<td>12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Unfortunately, this still gave us participant number and age again. We could exclude those explicitly by chaining methods.</p>
<div id="cell-67" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df.select(cs.numeric().exclude(<span class="st">'age'</span>, <span class="st">'participant number'</span>)).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>65</td>
<td>80</td>
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
<td>9</td>
<td>13</td>
<td>2</td>
</tr>
<tr class="even">
<td>90</td>
<td>90</td>
<td>90.0</td>
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
<td>4</td>
<td>11</td>
<td>7</td>
</tr>
<tr class="odd">
<td>90</td>
<td>95</td>
<td>92.5</td>
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
<td>10</td>
<td>9</td>
<td>3</td>
</tr>
<tr class="even">
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
<td>13</td>
<td>8</td>
<td>20</td>
</tr>
<tr class="odd">
<td>60</td>
<td>65</td>
<td>62.5</td>
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
<td>13</td>
<td>9</td>
<td>12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Selectors also allow for set algebra. As a (contrived) example, let say we want all columns that are not of string data type that have spaces in the column heading and that we also want to exclude the participant number.</p>
<div id="cell-69" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df.select((<span class="op">~</span>cs.string() <span class="op">&amp;</span> cs.contains(<span class="st">' '</span>)).exclude(<span class="st">'participant number'</span>)).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 9)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>65</td>
<td>80</td>
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
</tr>
<tr class="even">
<td>90</td>
<td>90</td>
<td>90.0</td>
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
</tr>
<tr class="odd">
<td>90</td>
<td>95</td>
<td>92.5</td>
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
</tr>
<tr class="even">
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
</tr>
<tr class="odd">
<td>60</td>
<td>65</td>
<td>62.5</td>
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Notice that we used the complement operator <code>~</code> and the intersection operator <code>&amp;</code>. Selectors also support the union operator <code>|</code> and the difference operator <code>-</code>.</p>
<p>To close our discussion on selectors, we note that selectors are their own data type:</p>
<div id="cell-71" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(cs.string())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>polars.selectors._selector_proxy_</code></pre>
</div>
</div>
<p>Selectors can be converted to expressions so you can continue computing with the <code>as_expr()</code> method.</p>
<div id="cell-73" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(cs.string().as_expr())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>polars.expr.expr.Expr</code></pre>
</div>
</div>
</section>
<section id="computing-summary-statistics" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="computing-summary-statistics"><span class="header-section-number">2.9</span> Computing summary statistics</h2>
<p>To demonstrate a use of what we have learned so far, we can compute the mean percent correct for insomniacs and normal sleepers. We can filter the data frame according to the <code>insomnia</code> column, select the <code>percent correct</code> column and compute the mean.</p>
<p>To put them together in a new data frame, we make a dictionary and convert it to a data frame, which is one of the ways to make a Polars data frame. E.g.,</p>
<div id="cell-75" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pl.DataFrame(<span class="bu">dict</span>(a<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>], b<span class="op">=</span>[<span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>], c<span class="op">=</span>[<span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'three'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
</tr>
<tr class="even">
<th>i64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>4.5</td>
<td>"one"</td>
</tr>
<tr class="even">
<td>2</td>
<td>5.5</td>
<td>"two"</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6.5</td>
<td>"three"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now to make our data frame of means for insomniacs and normal sleepers.</p>
<div id="cell-77" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>pl.DataFrame(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'insomniacs'</span>: df.<span class="bu">filter</span>(pl.col(<span class="st">'insomnia'</span>)).get_column(<span class="st">'percent correct'</span>).mean(),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'normal sleepers'</span>: df.<span class="bu">filter</span>(<span class="op">~</span>pl.col(<span class="st">'insomnia'</span>)).get_column(<span class="st">'percent correct'</span>).mean()</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">insomniacs</th>
<th data-quarto-table-cell-role="th">normal sleepers</th>
</tr>
<tr class="even">
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>76.1</td>
<td>81.461039</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Notice that I used the <code>~</code> operator, which is a bit switcher, to get the normal sleepers from the <code>insomnia</code> column. It changes all <code>True</code>s to <code>False</code>s and vice versa. In this case, it functions like NOT.</p>
<p>It appears as though normal sleepers score better than insomniacs. We will learn techniques to more quantitatively assess that claim when we learn about statistical inference.</p>
<p>As we will soon see, what we have done is a split-apply-combine operation, for which there are more elegant and efficient methods using Polars. You will probably never use the approach in the above code cell again.</p>
<p>We will do a lot more computing with Polars data frames as the course goes on. For a nifty demonstration demonstration in this lesson, we can quickly compute summary statistics about each column of a data frame using its <code>describe()</code> method.</p>
<div id="cell-79" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9, 17)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">statistic</th>
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">sci</th>
<th data-quarto-table-cell-role="th">psqi</th>
<th data-quarto-table-cell-role="th">ess</th>
<th data-quarto-table-cell-role="th">insomnia</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"count"</td>
<td>102.0</td>
<td>"102"</td>
<td>102.0</td>
<td>102.0</td>
<td>102.0</td>
<td>102.0</td>
<td>102.0</td>
<td>84.0</td>
<td>102.0</td>
<td>93.0</td>
<td>102.0</td>
<td>99.0</td>
<td>102.0</td>
<td>102.0</td>
<td>102.0</td>
<td>102.0</td>
</tr>
<tr class="even">
<td>"null_count"</td>
<td>0.0</td>
<td>"0"</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>18.0</td>
<td>0.0</td>
<td>9.0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>"mean"</td>
<td>52.04902</td>
<td>null</td>
<td>37.921569</td>
<td>83.088235</td>
<td>77.205882</td>
<td>80.147059</td>
<td>74.990196</td>
<td>58.565476</td>
<td>71.137255</td>
<td>61.22043</td>
<td>74.642157</td>
<td>61.979798</td>
<td>22.245098</td>
<td>5.27451</td>
<td>7.294118</td>
<td>0.245098</td>
</tr>
<tr class="even">
<td>"std"</td>
<td>30.020909</td>
<td>null</td>
<td>14.02945</td>
<td>15.09121</td>
<td>17.569854</td>
<td>12.047881</td>
<td>14.165916</td>
<td>19.560653</td>
<td>14.987479</td>
<td>17.671283</td>
<td>13.619725</td>
<td>15.92167</td>
<td>7.547128</td>
<td>3.404007</td>
<td>4.426715</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"min"</td>
<td>1.0</td>
<td>"f"</td>
<td>16.0</td>
<td>35.0</td>
<td>20.0</td>
<td>40.0</td>
<td>29.5</td>
<td>7.0</td>
<td>19.0</td>
<td>17.0</td>
<td>24.0</td>
<td>24.5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>"25%"</td>
<td>26.0</td>
<td>null</td>
<td>26.0</td>
<td>75.0</td>
<td>70.0</td>
<td>72.5</td>
<td>66.0</td>
<td>47.0</td>
<td>64.5</td>
<td>50.0</td>
<td>66.0</td>
<td>51.0</td>
<td>17.0</td>
<td>3.0</td>
<td>4.0</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"50%"</td>
<td>53.0</td>
<td>null</td>
<td>37.0</td>
<td>90.0</td>
<td>80.0</td>
<td>85.0</td>
<td>75.0</td>
<td>56.5</td>
<td>71.5</td>
<td>61.0</td>
<td>76.0</td>
<td>61.5</td>
<td>24.0</td>
<td>5.0</td>
<td>7.0</td>
<td>null</td>
</tr>
<tr class="even">
<td>"75%"</td>
<td>78.0</td>
<td>null</td>
<td>45.0</td>
<td>95.0</td>
<td>90.0</td>
<td>87.5</td>
<td>87.0</td>
<td>73.0</td>
<td>80.0</td>
<td>74.0</td>
<td>82.5</td>
<td>73.0</td>
<td>29.0</td>
<td>7.0</td>
<td>10.0</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"max"</td>
<td>103.0</td>
<td>"m"</td>
<td>74.0</td>
<td>100.0</td>
<td>100.0</td>
<td>100.0</td>
<td>100.0</td>
<td>92.0</td>
<td>100.0</td>
<td>100.0</td>
<td>100.0</td>
<td>100.0</td>
<td>32.0</td>
<td>15.0</td>
<td>21.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This gives us a data frame with summary statistics.</p>
<section id="outputting-a-new-csv-file" class="level3" data-number="2.9.1">
<h3 data-number="2.9.1" class="anchored" data-anchor-id="outputting-a-new-csv-file"><span class="header-section-number">2.9.1</span> Outputting a new CSV file</h3>
<p>Now that we added the insomniac column, we might like to save our data frame as a new CSV that we can reload later. We use <code>df.write_csv()</code> for this.</p>
<div id="cell-82" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df.write_csv(<span class="st">"gfmt_sleep_with_insomnia.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s take a look at what this file looks like.</p>
<div id="cell-84" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>head gfmt_sleep_with_insomnia.csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>participant number,gender,age,correct hit percentage,correct reject percentage,percent correct,confidence when correct hit,confidence incorrect hit,confidence correct reject,confidence incorrect reject,confidence when correct,confidence when incorrect,sci,psqi,ess,insomnia
8,f,39,65,80,72.5,91.0,90.0,93.0,83.5,93.0,90.0,9,13,2,true
16,m,42,90,90,90.0,75.5,55.5,70.5,50.0,75.0,50.0,4,11,7,true
18,f,31,90,95,92.5,89.5,90.0,86.0,81.0,89.0,88.0,10,9,3,true
22,f,35,100,75,87.5,89.5,,71.0,80.0,88.0,80.0,13,8,20,true
27,f,74,60,65,62.5,68.5,49.0,61.0,49.0,65.0,49.0,13,9,12,true
28,f,61,80,20,50.0,71.0,63.0,31.0,72.5,64.5,70.5,15,14,2,true
30,m,32,90,75,82.5,67.0,56.5,66.0,65.0,66.0,64.0,16,9,3,true
33,m,62,45,90,67.5,54.0,37.0,65.0,81.5,62.0,61.0,14,9,9,true
34,f,33,80,100,90.0,70.5,76.5,64.5,,68.0,76.5,14,12,10,true</code></pre>
</div>
</div>
<p>Very nice. Notice that by default Polars leaves an empty field for null values, and we do not need the <code>null_values</code> kwarg when we load in this CSV file.</p>
</section>
</section>
<section id="renaming-columns" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="renaming-columns"><span class="header-section-number">2.10</span> Renaming columns</h2>
<p>You may be annoyed with the rather lengthy syntax of access column names and wish to change them. Actually, you probably do not want to do this. Explicit is better than implicit! And furthermore, high level plotting libraries, as we will soon see, often automatically use column names for axis labels. So, let’s instead lengthen a column name. Say we keep forgetting what ESS stands for an want to rename the ess column to “Epworth Sleepiness Scale.”</p>
<p>Data frames have a nice <code>rename</code> method to do this. To rename the columns, we provide a dictionary where the keys are current column names and the corresponding values are the names we which to check them to. While we are at it, we will choose descriptive names for all three of the sleep quality indices.</p>
<div id="cell-87" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a dictionary to rename columns</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>rename_dict <span class="op">=</span> {</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ess"</span>: <span class="st">"Epworth Sleepiness Scale"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sci"</span>: <span class="st">"Sleep Condition Indicator"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"psqi"</span>: <span class="st">"Pittsburgh Sleep Quality Index"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the columns</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.rename(rename_dict)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 16)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">participant number</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">correct hit percentage</th>
<th data-quarto-table-cell-role="th">correct reject percentage</th>
<th data-quarto-table-cell-role="th">percent correct</th>
<th data-quarto-table-cell-role="th">confidence when correct hit</th>
<th data-quarto-table-cell-role="th">confidence incorrect hit</th>
<th data-quarto-table-cell-role="th">confidence correct reject</th>
<th data-quarto-table-cell-role="th">confidence incorrect reject</th>
<th data-quarto-table-cell-role="th">confidence when correct</th>
<th data-quarto-table-cell-role="th">confidence when incorrect</th>
<th data-quarto-table-cell-role="th">Sleep Condition Indicator</th>
<th data-quarto-table-cell-role="th">Pittsburgh Sleep Quality Index</th>
<th data-quarto-table-cell-role="th">Epworth Sleepiness Scale</th>
<th data-quarto-table-cell-role="th">insomnia</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>bool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td>"f"</td>
<td>39</td>
<td>65</td>
<td>80</td>
<td>72.5</td>
<td>91.0</td>
<td>90.0</td>
<td>93.0</td>
<td>83.5</td>
<td>93.0</td>
<td>90.0</td>
<td>9</td>
<td>13</td>
<td>2</td>
<td>true</td>
</tr>
<tr class="even">
<td>16</td>
<td>"m"</td>
<td>42</td>
<td>90</td>
<td>90</td>
<td>90.0</td>
<td>75.5</td>
<td>55.5</td>
<td>70.5</td>
<td>50.0</td>
<td>75.0</td>
<td>50.0</td>
<td>4</td>
<td>11</td>
<td>7</td>
<td>true</td>
</tr>
<tr class="odd">
<td>18</td>
<td>"f"</td>
<td>31</td>
<td>90</td>
<td>95</td>
<td>92.5</td>
<td>89.5</td>
<td>90.0</td>
<td>86.0</td>
<td>81.0</td>
<td>89.0</td>
<td>88.0</td>
<td>10</td>
<td>9</td>
<td>3</td>
<td>true</td>
</tr>
<tr class="even">
<td>22</td>
<td>"f"</td>
<td>35</td>
<td>100</td>
<td>75</td>
<td>87.5</td>
<td>89.5</td>
<td>null</td>
<td>71.0</td>
<td>80.0</td>
<td>88.0</td>
<td>80.0</td>
<td>13</td>
<td>8</td>
<td>20</td>
<td>true</td>
</tr>
<tr class="odd">
<td>27</td>
<td>"f"</td>
<td>74</td>
<td>60</td>
<td>65</td>
<td>62.5</td>
<td>68.5</td>
<td>49.0</td>
<td>61.0</td>
<td>49.0</td>
<td>65.0</td>
<td>49.0</td>
<td>13</td>
<td>9</td>
<td>12</td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="a-note-on-indexing-and-speed" class="level2" data-number="2.11">
<h2 data-number="2.11" class="anchored" data-anchor-id="a-note-on-indexing-and-speed"><span class="header-section-number">2.11</span> A note on indexing and speed</h2>
<p>As we have seen Boolean indexing is very convenient and fits nicely into a logical framework which allows us to extract data according to criteria we want. The trade-off is speed. Slicing by Boolean indexing is essentially doing a reverse lookup in a dictionary. We have to loop through all values to find keys that match. This is much slower than directly indexing. Compare the difference in speed for indexing the percent correct by participant number 42 by Boolean indexing versus direct indexing (it’s row 54).</p>
<div id="cell-89" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Boolean indexing:"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit df.<span class="bu">filter</span>(pl.col(<span class="st">'participant number'</span>) <span class="op">==</span> <span class="dv">42</span>)[<span class="st">'percent correct'</span>].item()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Direct indexing:"</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit df[<span class="dv">54</span>, <span class="st">'percent correct'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Boolean indexing:
100 μs ± 471 ns per loop (mean ± std. dev. of 7 runs, 10,000 loops each)

Direct indexing:
533 ns ± 5.07 ns per loop (mean ± std. dev. of 7 runs, 1,000,000 loops each)</code></pre>
</div>
</div>
<p>The speed difference is stark, differing by two orders of magnitude. For larger data sets, or for analyses that require repeated indexing, this speed consideration may be important. However, Polars does optimization that takes full advantage of parallelization that will accelerate Boolean indexing.</p>
</section>
<section id="computing-environment" class="level2" data-number="2.12">
<h2 data-number="2.12" class="anchored" data-anchor-id="computing-environment"><span class="header-section-number">2.12</span> Computing environment</h2>
<div id="cell-92" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext watermark</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>watermark <span class="op">-</span>v <span class="op">-</span>p numpy,polars,jupyterlab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Python implementation: CPython
Python version       : 3.12.9
IPython version      : 9.1.0

numpy     : 2.1.3
polars    : 1.27.1
jupyterlab: 4.3.6
</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/bebi103a\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../lessons/eda/exploratory_data_analysis.html" class="pagination-link" aria-label="Exploratory data analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Exploratory data analysis</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../lessons/eda/polars/tidy_data.html" class="pagination-link" aria-label="Tidy data and split-apply-combine">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tidy data and split-apply-combine</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><em>BE/Bi 103 a 2025</em></p>
</div>
  </div>
</footer>




</body></html>